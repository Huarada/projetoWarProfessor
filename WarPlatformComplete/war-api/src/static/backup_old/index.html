<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAR Platform - Estrat√©gia e Teoria dos Jogos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        header {
            background: white;
            border-bottom: 1px solid #eaeaea;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        nav {
            display: flex;
            gap: 2rem;
        }
        
        nav a, nav button {
            text-decoration: none;
            color: #333;
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        nav a:hover, nav button:hover {
            color: #000;
        }
        
        .btn {
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: background 0.3s, transform 0.1s;
        }
        
        .btn:hover {
            transform: translateY(-1px);
        }
        
        .btn-primary {
            background-color: #2c3e50;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1a252f;
        }
        
        .btn-secondary {
            background-color: white;
            color: #2c3e50;
            border: 1px solid #2c3e50;
        }
        
        .btn-secondary:hover {
            background-color: #f8fafc;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        /* Game Section */
        .game-section {
            background: white;
            margin: 2rem 0;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .game-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .game-board {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            min-height: 400px;
            background: #f8fafc;
        }
        
        .map-container {
            position: relative;
            height: 400px;
            background: linear-gradient(180deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            overflow: hidden;
        }
        
        .territory {
            position: absolute;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid white;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: transform 0.1s;
        }
        
        .territory:hover {
            transform: translate(-50%, -50%) scale(1.1);
        }
        
        .players-panel {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .panel {
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            padding: 1rem;
        }
        
        .player-list {
            list-style: none;
            display: grid;
            gap: 0.5rem;
        }
        
        .player-item {
            display: grid;
            grid-template-columns: 24px 1fr;
            gap: 0.5rem;
            align-items: center;
            padding: 0.5rem;
            border-radius: 6px;
            background: #f9fafb;
        }
        
        .player-color {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid white;
        }
        
        .analysis-panel {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            background: #fff7ed;
            border: 1px solid #fed7aa;
        }
        
        .hidden { display: none; }
        
        .stat {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            background: #f1f5f9;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        /* Responsivo */
        @media (max-width: 768px) {
            .players-panel {
                grid-template-columns: 1fr;
            }
            
            nav {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>

    <!-- Tailwind e √≠cones -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="logo">
                  <img src="./assets/war-logo-CydTCxCt.png" alt="WAR Logo" class="h-12 w-12" />
                </div>
                <nav class="hidden md:flex space-x-8 navbar-tailwind">
                  <button id="btnIniciar" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded">Iniciar Jogo</button>
                  <a href="https://patreon.com/Huarada?utm_medium=unknown&utm_source=join_link&utm_campaign=creatorshare_creator&utm_content=copyLink" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded inline-flex items-center justify-center">Patreon</a>
                  <a href="#home-section" class="text-gray-700 hover:text-gray-900 px-3 py-2">Home</a>
                  <a href="https://github.com/Huarada/JupyterNotebookAlgoritmoWar" class="text-gray-700 hover:text-gray-900 px-3 py-2">Aprenda Estrat√©gia</a>
                  <a href="#community" class="text-gray-700 hover:text-gray-900 px-3 py-2">Comunidade</a>
                  <a href="#about" class="text-gray-700 hover:text-gray-900 px-3 py-2">Sobre</a>
                  <a href="#contact" class="text-gray-700 hover:text-gray-900 px-3 py-2">Contato</a>
                </nav>
                <div class="flex space-x-2">
                    <button class="border px-4 py-2 rounded text-gray-800">Sign in</button>
                    <button class="bg-gray-800 hover:bg-gray-900 text-white px-4 py-2 rounded">Register</button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Home Section -->
        <div id="home-section">
          <!-- Mapa Mundial -->
          <section class="bg-black py-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <img id="mapaMundial" src="./assets/world-map-jh4EBnhG.png" alt="Mapa Mundial WAR" class="w-full h-auto" />
            </div>
          </section>

          <!-- Blocos de recursos -->
          <footer class="bg-gray-200 py-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                  <h3 class="font-bold text-gray-900 mb-4">Aprenda e Pratique</h3>
                  <ul class="space-y-2 text-gray-700">
                    <li><a href="https://www.youtube.com/watch?v=gOH3lXcDrEA" class="hover:text-gray-900">Tutorial de como jogar WAR</a></li>
                    <li><a href="https://pt.khanacademy.org/economics-finance-domain/microeconomics/perfect-competition-topic/game-theory/e/game-theory" class="hover:text-gray-900">Exerc√≠cios de tomada de decis√£o</a></li>
                    <li><a href="https://github.com/Huarada/JupyterNotebookAlgoritmoWar" class="hover:text-gray-900">Estrat√©gias de ataque e defesa</a></li>
                  </ul>
                </div>
                <div>
                  <h3 class="font-bold text-gray-900 mb-4">Ferramentas e Demonstra√ß√µes</h3>
                  <ul class="space-y-2 text-gray-700">
                    <li><a href="https://github.com/Huarada/JupyterNotebookAlgoritmoWar" class="hover:text-gray-900">Constru√ß√£o do Algoritmo Gen√©tico</a></li>
                    <li><a href="#" class="hover:text-gray-900">Hist√≥rico de partidas simuladas</a></li>
                    <li><a href="#" class="hover:text-gray-900">Constru√ß√£o do Mapa</a></li>
                  </ul>
                </div>
                <div class="md:col-start-3">
                  <h3 class="font-bold text-gray-900 mb-4">Recursos e Comunidade</h3>
                  <ul class="space-y-2 text-gray-700">
                    <li><a href="https://www.britannica.com/science/game-theory/Two-person-constant-sum-games" class="hover:text-gray-900">Materiais para professores e educadores</a></li>
                    <li><a href="https://www.britannica.com/science/game-theory/Two-person-constant-sum-games" class="hover:text-gray-900">Artigos e tutoriais sobre Teoria dos Jogos</a></li>
                    <li><a href="https://discord.gg/xQw4dmhX" class="hover:text-gray-900">Comunidade (Discord)</a></li>
                    <li><a href="https://github.com/Huarada/projetoWarProfessor" class="hover:text-gray-900">Projeto (GitHub)</a></li>
                    <li><a href="#licenseForOpenSource" class="hover:text-gray-900">Licen√ßa MIT e termos de uso</a></li>
                    <li><a href="https://www.linkedin.com/in/eng-lucas-harada/" class="hover:text-gray-900">Developers</a></li>
                    <li><a href="mailto:lucasharada@usp.br" class="hover:text-gray-900">Contato/Suporte oficial</a></li>
                  </ul>
                </div>
              </div>
              <div class="flex space-x-4 mt-8">
                <a href="https://x.com/LucasHarada5?t=UBWFBRSfWdpvMI72sj9Zsg&s=08" aria-label="Twitter/X"><i data-lucide="twitter" class="h-6 w-6 text-gray-600"></i></a>
                <a href="https://www.instagram.com/lucas.harada.94?utm_source=qr&igsh=MTkxdjFrZ2N6bW1qcQ==" aria-label="Instagram"><i data-lucide="instagram" class="h-6 w-6 text-gray-600"></i></a>
                <a href="https://github.com/Huarada" aria-label="GitHub"><i data-lucide="github" class="h-6 w-6 text-gray-600"></i></a>
                <a href="https://www.linkedin.com/in/eng-lucas-harada/" aria-label="LinkedIn"><i data-lucide="linkedin" class="h-6 w-6 text-gray-600"></i></a>
              </div>
            </div>
          </footer>
    <!-- Sobre a Plataforma Section -->
    <section class="bg-gray-100 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 id="sobrePlataforma" class="text-4xl font-bold text-gray-900 mb-8">Sobre a Plataforma</h2>
        <div class="text-gray-700 space-y-4 text-left">
          <p>
            Este site √© parte do Trabalho de Conclus√£o de Curso (TCC) de Lucas Harada na POLI-USP, orientado pelo Prof. M√°rcio Lobo Neto. O objetivo do projeto √©
            tornar o ensino de estrat√©gia e Teoria dos Jogos mais acess√≠vel, pr√°tico e divertido, utilizando o jogo WAR como ferramenta.
          </p>
          <p>
            O projeto nasceu a partir da falta de recursos l√∫dicos para explicar conceitos estrat√©gicos de forma aplicada. A plataforma permite que estudantes, professores
            e entusiastas do jogo tenham acesso a um agente aut√¥nomo de IA, que utiliza Algoritmos Gen√©ticos para treinar sua estrat√©gia ao longo do tempo.
          </p>
          <p>
            Al√©m da experi√™ncia de jogo, o agente explica suas jogadas e escolhas utilizando processamento de linguagem natural (NLP), tornando o aprendizado mais
            transparente e interativo.
          </p>
          <p>
            O c√≥digo do agente ser√° disponibilizado como open-source sob licen√ßa MIT, permitindo liberdade de uso e adapta√ß√£o, sem responsabilidade do autor por usos
            indevidos.
          </p>
          <p>
            Este site √© gratuito para uso educacional, com possibilidade de planos premium para funcionalidades avan√ßadas. Acreditamos que o ensino de estrat√©gia deve
            ser acess√≠vel, l√∫dico e envolvente para todos.
          </p>
        </div>
      </div>
    </section>

    <!-- Como Jogar WAR Section -->
    <section class="bg-gray-2 00 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-4xl font-bold text-gray-900 mb-8 text-center">Como Jogar WAR</h2>
        <div class="text-gray-700 space-y-6">
          <div>
            <h3 class="text-xl font-bold mb-2">1. Objetivo do Jogo</h3>
            <p>
              Cada jogador recebe uma miss√£o secreta (como conquistar certos continentes ou eliminar um advers√°rio). Quem cumprir sua miss√£o primeiro, ou tiver
              mais territ√≥rios at√© a √∫ltima rodada, vence.
            </p>
          </div>

          <div>
            <h3 class="text-xl font-bold mb-2">2. Preparando o Tabuleiro</h3>
            <ul class="list-disc list-inside space-y-1 ml-4">
              <li>Cada jogador escolhe uma cor e pega seus ex√©rcitos.</li>
              <li>Os territ√≥rios s√£o sorteados e distribu√≠dos entre os jogadores.</li>
              <li>Cada jogador coloca uma tropa em cada territ√≥rio que ganhou.</li>
              <li>Depois, distribua o resto das tropas como quiser nos seus territ√≥rios.</li>
            </ul>
          </div>

          <div>
            <h3 class="text-xl font-bold mb-2">3. Como Funciona o Seu Turno</h3>
            <p>Seu turno tem tr√™s partes:</p>
            <div class="ml-4 space-y-2">
              <div>
                <strong>a) Receber Novas Tropas</strong>
                <p class="ml-4">
                  No come√ßo do turno, conte quantos territ√≥rios voc√™ tem. Divida por 2 (arredonde para baixo) para saber quantas tropas novas recebe.
                  Exemplo: 11 territ√≥rios ‚Üí ganha 5 tropas.
                </p>
              </div>
              <div>
                <strong>b) Colocar Tropas</strong>
                <p class="ml-4">Coloque suas novas tropas em qualquer territ√≥rio que j√° seja seu.</p>
              </div>
              <div>
                <strong>c) Atacar (opcional)</strong>
                <p class="ml-4">Voc√™ pode atacar territ√≥rios vizinhos que pertencem a outros jogadores.</p>
                <ul class="list-disc list-inside ml-8 space-y-1">
                  <li>Para atacar, escolha de onde vai atacar e para onde.</li>
                  <li>Use dados: quem ataca usa at√© 3 dados, quem defende at√© 2.</li>
                  <li>Quem tirar o maior n√∫mero no dado ganha (empate √© do defensor).</li>
                  <li>Se o atacante vencer, o defensor perde uma tropa.</li>
                  <li>Se o defensor perder todas as tropas, o atacante toma o territ√≥rio.</li>
                </ul>
              </div>
              <div>
                <strong>d) Mover Tropas</strong>
                <p class="ml-4">
                  No fim do seu turno, voc√™ pode mover tropas de um territ√≥rio para outro seu, desde que estejam conectados.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Comunidade Section -->
    <section class="bg-gray-300 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-4xl font-bold text-gray-900 mb-8">COMUNIDADE</h2>
        <p class="text-gray-700 mb-4">
          Interaja com outros entusiastas de WAR e com contribuidores do c√≥digo Open-Source em nossa comunidade do Discord
        </p>
        <p class="text-gray-700">
          <a href="https://discord.gg/xQw4dmhX" class="text-blue-600 hover:underline">link: https://discord.gg/xQw4dmhX</a>
        </p>
      </div>
    </section>

    <!-- Projeto Section -->
    <section class="bg-gray-200 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-4xl font-bold text-gray-900 mb-8">Projeto</h2>
        <p class="text-gray-700 mb-4">
          Gostaria de aprender mais sobre Algoritmos Gen√©ticos e contribuir com nosso projeto Open-Source junto de outros desenvolvedores? Acesse nosso link do
          github
        </p>
        <p class="text-gray-700"><a href="https://github.com/Huarada/projetoWarProfessor" class="text-blue-600 hover:underline">Link: https://github.com/Huarada/projetoWarProfessor</a></p>
      </div>
    </section>

    <!-- Algoritmo Gen√©tico Section -->
    <section class="bg-gray-300 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-4xl font-bold text-gray-900 mb-8">Algoritmo Gen√©tico Implementado</h2>
        <p class="text-gray-700 mb-4">
          O c√≥digo do algoritmo gen√©tico usado para os agentes aut√¥nomos jogarem WAR pode ser encontrado no seguinte reposit√≥rio do GitHub
        </p>
        <p class="text-gray-700"><a href="https://github.com/Huarada/JupyterNotebookAlgoritmoWar" class="text-blue-600 hover:underline">Link: https://github.com/Huarada/JupyterNotebookAlgoritmoWar</a></p>
      </div>
    </section>

    <!-- Licen√ßa OpenSource Section -->
    <section class="bg-gray-200 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-4xl font-bold text-gray-900 mb-8">Licen√ßa OpenSource</h2>
        <p class="text-gray-700 mb-8">
          A licen√ßa usada no projeto de WAR usando algoritmo gen√©tico √© a MIT License abaixo
        </p>

        <div id="licenseForOpenSource" class="bg-white p-8 rounded-lg shadow-lg text-left">
          <p class="text-center font-bold mb-4">Copyright 2025 Lucas Harada</p>
          <p class="text-sm text-gray-600 leading-relaxed">
            Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the
            Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the
            Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
          </p>
          <p class="text-sm text-gray-600 leading-relaxed mt-4">
            The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
          </p>
          <p class="text-sm text-gray-600 leading-relaxed mt-4">
            THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
            MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
            LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
            CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
          </p>
        </div>

        <div class="mt-8">
          <img src="./assets/open-source-logo.png" alt="Open Source Initiative" class="mx-auto h-32 w-32" />
        </div>
      </div>
    </section>

    <!-- Contatos Section -->
    <section class="bg-gray-300 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-4xl font-bold text-gray-900 mb-8">Contatos</h2>
        <div class="flex justify-center space-x-8">
          <a href="https://x.com/LucasHarada5?t=UBWFBRSfWdpvMI72sj9Zsg&s=08" aria-label="Twitter/X"><i data-lucide="twitter" class="h-6 w-6 text-gray-600"></i></a>
          <a href="https://www.instagram.com/lucas.harada.94?utm_source=qr&igsh=MTkxdjFrZ2N6bW1qcQ==" aria-label="Instagram"><i data-lucide="instagram" class="h-6 w-6 text-gray-600"></i></a>
          <a href="https://github.com/Huarada" aria-label="GitHub"><i data-lucide="github" class="h-6 w-6 text-gray-600"></i></a>
          <a href="https://www.linkedin.com/in/eng-lucas-harada/" aria-label="LinkedIn"><i data-lucide="linkedin" class="h-6 w-6 text-gray-600"></i></a>
        </div>
      </div>
    </section>
        </div>

        <!-- Game Section -->
        <div id="game-section" class="hidden">
            <div class="game-section">
                <h2>Simulador de WAR com IA</h2>
                <p>Inicie uma nova partida ou execute turnos autom√°ticos. Use o painel para visualizar territ√≥rios, jogadores e estat√≠sticas.</p>
                
                <div class="game-controls">
                    <button class="btn btn-success" onclick="startNewGame()">Novo Jogo</button>
                    <button class="btn btn-primary" onclick="nextTurn()">Pr√≥ximo Turno</button>
                    <button class="btn btn-warning" onclick="toggleAutoPlay()">Auto Play</button>
                    <button class="btn btn-secondary" onclick="analyzeMove()" id="analyze-move">Analisar Jogada (IA)</button>
                    <label style="display:flex; align-items:center; gap:6px;">
                        <input type="checkbox" id="auto-play"> Ativar Auto Play
                    </label>
                    <label style="display:flex; align-items:center; gap:6px;">
                        Velocidade:
                        <select id="speed">
                            <option value="slow">Lento</option>
                            <option value="normal" selected>Normal</option>
                            <option value="fast">R√°pido</option>
                        </select>
                    </label>
                </div>

                <div class="game-board">
                    <div id="map-container" class="map-container"></div>
                    
                    <div class="players-panel">
                        <div class="panel">
                            <h3>Mapa e Territ√≥rios</h3>
                            <div id="territories-info" style="max-height: 240px; overflow: auto;"></div>
                        </div>
                        
                        <div class="sidebar">
                            <div class="panel">
                                <h3>Jogadores</h3>
                                <ul id="players-list" class="player-list"></ul>
                            </div>
                            
                            <div class="panel">
                                <h3>√öltima A√ß√£o</h3>
                                <div id="last-action">Nenhuma a√ß√£o ainda</div>
                            </div>
                            
                            <div class="panel">
                                <h3>Estat√≠sticas</h3>
                                <div id="stats">
                                    <div>Turnos: <span id="turns">0</span></div>
                                    <div>Rodada: <span id="round">0</span></div>
                                    <div>Status: <span id="status">Aguardando</span></div>
                                </div>
                            </div>
                            
                            <div id="analysis-panel" class="analysis-panel hidden">
                                <h3>An√°lise da Jogada (IA)</h3>
                                <div id="analysis-content"></div>
                                <button class="btn btn-secondary" onclick="closeAnalysis()">Fechar</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="log" class="panel" style="margin-top: 1rem;">
                    <h3>Hist√≥rico de A√ß√µes</h3>
                    <div id="history" style="max-height: 200px; overflow: auto; background: #f8fafc; padding: 0.5rem; border-radius: 6px;"></div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let gameId = null;
        let gameState = null;
        let autoPlayInterval = null;
        
        const TERRITORY_POSITIONS = {
            "Alasca": { x: 80, y: 80 },
            "Vancouver": { x: 120, y: 100 },
            "Calgary": { x: 140, y: 80 },
            "Groenl√¢ndia": { x: 300, y: 60 },
            "Labrador": { x: 260, y: 100 },
            "Nova York": { x: 220, y: 140 },
            "M√©xico": { x: 160, y: 180 },
            "Venezuela": { x: 220, y: 220 },
            "Peru": { x: 200, y: 260 },
            "Brasil": { x: 240, y: 260 },
            "Argentina": { x: 220, y: 300 },
            "Reino Unido": { x: 340, y: 120 },
            "Isl√¢ndia": { x: 320, y: 100 },
            "Espanha": { x: 360, y: 160 },
            "Fran√ßa": { x: 380, y: 160 },
            "Alemanha": { x: 400, y: 150 },
            "Pol√¥nia": { x: 420, y: 150 },
            "It√°lia": { x: 400, y: 180 },
            "Noruega": { x: 380, y: 120 },
            "Moscou": { x: 460, y: 140 },
            "Omsk": { x: 480, y: 140 },
            "Aral": { x: 460, y: 160 },
            "China": { x: 500, y: 180 },
            "√çndia": { x: 480, y: 200 },
            "Oriente M√©dio": { x: 440, y: 180 },
            "Jap√£o": { x: 580, y: 160 },
            "Vietn√£": { x: 520, y: 200 },
            "Born√©u": { x: 540, y: 220 },
            "Sumatra": { x: 520, y: 240 },
            "Nova Guin√©": { x: 580, y: 220 },
            "Austr√°lia": { x: 600, y: 260 },
            "Egito": { x: 380, y: 200 },
            "Arg√©lia": { x: 340, y: 200 },
            "Congo": { x: 360, y: 240 },
            "Sud√£o": { x: 400, y: 220 },
            "Madagascar": { x: 420, y: 280 },
            "√Åfrica do Sul": { x: 380, y: 300 }
        };

        function showHome() {
            document.getElementById('home-section').classList.remove('hidden');
            document.getElementById('game-section').classList.add('hidden');
        }

        function showGame() {
            document.getElementById('home-section').classList.add('hidden');
            document.getElementById('game-section').classList.remove('hidden');
        }

        async function startNewGame() {
            const autoPlay = document.getElementById('auto-play').checked;
            const speed = document.getElementById('speed').value;
            
            try {
                const response = await fetch('/api/game/start', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ auto_play: autoPlay, speed: speed })
                });
                
                const data = await response.json();
                if (data.success) {
                    gameId = data.game_id;
                    gameState = data.state;
                    updateUI();
                    enableGameControls();
                    
                    if (autoPlay) {
                        startAutoPlay();
                    }
                }
            } catch (error) {
                console.error('Erro ao iniciar jogo:', error);
                alert('Erro ao iniciar jogo. Verifique se o servidor est√° rodando.');
            }
        }

        async function nextTurn() {
            if (!gameId) return;
            
            try {
                const response = await fetch(`/api/game/${gameId}/next-turn`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                if (data.success) {
                    gameState = data.state;
                    updateUI();
                    
                    if (gameState.status === 'finished') {
                        stopAutoPlay();
                        alert(`Jogo finalizado! Vencedor: ${gameState.winner?.name || 'Desconhecido'}`);
                    }
                }
            } catch (error) {
                console.error('Erro ao executar turno:', error);
            }
        }

        async function analyzeMove() {
            if (!gameId) return;
            
            const button = document.getElementById('analyze-move');
            button.textContent = 'üß† Analisando...';
            button.disabled = true;
            
            try {
                const response = await fetch(`/api/game/${gameId}/analyze-move`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                if (data.success) {
                    showAnalysis(data.analysis);
                } else {
                    alert('Falha na an√°lise');
                }
            } catch (error) {
                console.error('Erro na an√°lise:', error);
            } finally {
                button.textContent = 'Analisar Jogada (IA)';
                button.disabled = false;
            }
        }

        function showAnalysis(analysis) {
            const panel = document.getElementById('analysis-panel');
            const content = document.getElementById('analysis-content');
            
            content.innerHTML = `
                <p><strong>Jogador:</strong> ${analysis.player.name}</p>
                <p><strong>A√ß√£o sugerida:</strong> ${analysis.suggested_action}</p>
                <p><strong>Justificativa:</strong> ${analysis.explanation}</p>
                <p><strong>Avalia√ß√£o de risco:</strong> ${analysis.risk_assessment}</p>
            `;
            
            panel.classList.remove('hidden');
        }

        function closeAnalysis() {
            document.getElementById('analysis-panel').classList.add('hidden');
        }

        function enableGameControls() {
            document.querySelectorAll('.game-controls button').forEach(btn => btn.disabled = false);
        }

        function toggleAutoPlay() {
            const checkbox = document.getElementById('auto-play');
            if (checkbox.checked) {
                startAutoPlay();
            } else {
                stopAutoPlay();
            }
        }

        function startAutoPlay() {
            stopAutoPlay();
            
            const speed = document.getElementById('speed').value;
            let interval = 1000;
            if (speed === 'slow') interval = 1500;
            if (speed === 'fast') interval = 400;
            
            autoPlayInterval = setInterval(() => {
                if (gameState?.status !== 'finished') {
                    nextTurn();
                } else {
                    stopAutoPlay();
                }
            }, interval);
        }

        function stopAutoPlay() {
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
            }
        }

        function updateUI() {
            if (!gameState) return;
            
            renderMap();
            renderTerritoriesInfo();
            renderPlayers();
            renderLastAction();
            updateStats(gameState.total_turns, gameState.current_round, gameState.status);
        }

        function renderMap() {
            const container = document.getElementById('map-container');
            container.innerHTML = '';
            
            if (!gameState.territories) return;
            
            Object.entries(gameState.territories).forEach(([name, data]) => {
                const position = TERRITORY_POSITIONS[name];
                if (!position) return;
                
                const territory = document.createElement('div');
                territory.className = 'territory';
                territory.style.left = position.x + 'px';
                territory.style.top = position.y + 'px';
                
                const owner = gameState.players.find(p => p.id === data.owner_id);
                const color = owner?.color || '#999';
                territory.style.background = color;
                
                territory.title = `${name} - Tropas: ${data.units}`;
                container.appendChild(territory);
            });
        }
        
        function renderTerritoriesInfo() {
            const infoDiv = document.getElementById('territories-info');
            let html = '<table style="width:100%; border-collapse: collapse; font-size: 0.9rem;">';
            html += '<thead><tr><th style="text-align:left; padding:4px;">Territ√≥rio</th><th style="text-align:left; padding:4px;">Jogador</th><th style="text-align:left; padding:4px;">Tropas</th></tr></thead><tbody>';
            
            if (gameState.territories) {
                Object.entries(gameState.territories).forEach(([name, data]) => {
                    const owner = gameState.players.find(p => p.id === data.owner_id);
                    html += `<tr>
                        <td style="padding:4px;">${name}</td>
                        <td style="padding:4px;">${owner?.name || 'N/A'}</td>
                        <td style="padding:4px;">${data.units}</td>
                    </tr>`;
                });
            }
            html += '</tbody></table>';
            infoDiv.innerHTML = html;
        }

        function renderPlayers() {
            const list = document.getElementById('players-list');
            list.innerHTML = '';
            
            if (!gameState.players) return;
            
            gameState.players.forEach(player => {
                const item = document.createElement('li');
                item.className = 'player-item';
                
                const color = document.createElement('div');
                color.className = 'player-color';
                color.style.background = player.color;
                
                const info = document.createElement('div');
                info.innerHTML = `<strong>${player.name}</strong><br>
                Territ√≥rios: ${player.territories_count} ‚Ä¢ Tropas: ${player.total_units}`;
                
                item.appendChild(color);
                item.appendChild(info);
                list.appendChild(item);
            });
        }

        function renderLastAction() {
            const div = document.getElementById('last-action');
            if (!gameState.last_action) {
                div.textContent = 'Nenhuma a√ß√£o ainda';
                return;
            }
            div.textContent = gameState.last_action;
            
            const history = document.getElementById('history');
            const p = document.createElement('div');
            p.textContent = gameState.last_action;
            history.prepend(p);
        }

        function updateStats(turns, round, status) {
            document.getElementById('turns').textContent = turns || 0;
            document.getElementById('round').textContent = round || 0;
            document.getElementById('status').textContent = status || 'Aguardando';
        }

        document.getElementById('speed').addEventListener('change', () => {
            if (autoPlayInterval) {
                stopAutoPlay();
                if (document.getElementById('auto-play').checked) {
                    startAutoPlay();
                }
            }
        });

        // Inicializar na tela home
        showHome();
    </script>

    <!-- Script para nav e √≠cones -->
    <script>
      (function(){
        const btn = document.getElementById('btnIniciar');
        if (btn) {
          btn.addEventListener('click', function(){
            try { showGame(); } catch(e) {}
            try { startNewGame(); } catch(e) {}
          });
        }
        if (window.lucide && window.lucide.createIcons) { window.lucide.createIcons(); }
      })();
    </script>

</body>
</html>

